{% extends "base_layout.html" %}

{% block title %}‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å - Mood Tracker{% endblock %}
{% block page_title %}üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å{% endblock %}

{% block extra_css %}
<style>
    .form-card {
        background: white;
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        margin-bottom: 30px;
    }
    
    .form-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }
    
    .form-header h2 {
        color: #333;
        font-size: 1.5em;
    }
    
    .btn-cancel {
        padding: 8px 16px;
        background-color: #6c757d;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        text-decoration: none;
        display: inline-block;
    }
    
    .edit-mode {
        border: 3px solid #ffd93d;
    }
    
    .form-group {
        margin-bottom: 20px;
    }
    
    label {
        display: block;
        margin-bottom: 8px;
        color: #333;
        font-weight: 600;
    }
    
    input, select, textarea {
        width: 100%;
        padding: 12px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 16px;
        transition: border-color 0.3s;
    }
    
    input:focus, select:focus, textarea:focus {
        outline: none;
        border-color: #667eea;
    }
    
    textarea {
        resize: vertical;
        min-height: 100px;
    }
    
    .color-options {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 10px;
    }
    
    .color-option {
        position: relative;
    }
    
    .color-option input[type="radio"] {
        position: absolute;
        opacity: 0;
    }
    
    .color-label {
        display: block;
        padding: 15px;
        text-align: center;
        border-radius: 10px;
        cursor: pointer;
        border: 3px solid transparent;
        transition: all 0.3s;
        font-weight: 600;
    }
    
    .color-option input[type="radio"]:checked + .color-label {
        border-color: #333;
        transform: scale(1.05);
    }
    
    .color-red { background-color: #ff6b6b; color: white; }
    .color-yellow { background-color: #ffd93d; color: #333; }
    .color-blue { background-color: #6bcfff; color: white; }
    .color-green { background-color: #51cf66; color: white; }
    
    .btn-submit {
        width: 100%;
        padding: 15px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 10px;
        font-size: 18px;
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.2s;
    }
    
    .btn-submit:hover {
        transform: translateY(-2px);
    }
    
    .mood-list {
        display: grid;
        gap: 15px;
    }
    
    .mood-item {
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        border-left: 5px solid;
    }
    
    .mood-item.‡πÅ‡∏î‡∏á { border-left-color: #ff6b6b; }
    .mood-item.‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á { border-left-color: #ffd93d; }
    .mood-item.‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô { border-left-color: #6bcfff; }
    .mood-item.‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß { border-left-color: #51cf66; }
    
    .mood-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
    }
    
    .mood-datetime {
        color: #666;
        font-size: 14px;
    }
    
    .mood-color-badge {
        padding: 5px 15px;
        border-radius: 20px;
        color: white;
        font-weight: 600;
        font-size: 14px;
    }
    
    .mood-emotion {
        font-size: 20px;
        font-weight: 600;
        color: #333;
        margin: 10px 0;
    }
    
    .mood-trigger {
        color: #666;
        margin-bottom: 10px;
    }
    
    .mood-detail {
        color: #555;
        line-height: 1.6;
        margin-bottom: 10px;
    }
    
    .mood-footer {
        display: flex;
        gap: 10px;
        margin-top: 15px;
    }
    
    .btn-edit, .btn-delete {
        padding: 8px 15px;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
    }
    
    .btn-edit {
        background-color: #4CAF50;
    }
    
    .btn-delete {
        background-color: #ff6b6b;
    }
    
    .empty-state {
        background: white;
        padding: 40px;
        text-align: center;
        border-radius: 12px;
        color: #999;
    }
    
    /* Tooltip Styles */
    .tooltip-container {
        position: relative;
        display: inline-block;
        margin-left: 8px;
    }
    
    .tooltip-icon {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 20px;
        height: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 50%;
        font-size: 14px;
        cursor: help;
    }
    
    .tooltip-content {
        visibility: hidden;
        opacity: 0;
        position: absolute;
        z-index: 1000;
        background-color: #333;
        color: white;
        padding: 15px 20px;
        border-radius: 10px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        width: 350px;
        top: 30px;
        left: 50%;
        transform: translateX(-50%);
        transition: opacity 0.3s;
        font-size: 14px;
        line-height: 1.6;
    }
    
    .tooltip-container:hover .tooltip-content {
        visibility: visible;
        opacity: 1;
    }
    
    .color-meanings {
        margin-top: 12px;
        padding-top: 12px;
        border-top: 1px solid rgba(255,255,255,0.2);
    }
    
    .color-meaning-item {
        display: flex;
        align-items: center;
        margin: 8px 0;
        gap: 10px;
    }
    
    .color-dot {
        width: 16px;
        height: 16px;
        border-radius: 50%;
    }
    
    @media (max-width: 768px) {
        .color-options {
            grid-template-columns: repeat(2, 1fr);
        }
    }
</style>
{% endblock %}

{% block content %}
<!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç -->
<div class="form-card {% if edit_mood %}edit-mode{% endif %}">
    <div class="form-header">
        <h2>{% if edit_mood %}‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å{% else %}‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏´‡∏°‡πà{% endif %}</h2>
        {% if edit_mood %}
        <a href="{{ url_for('dashboard') }}" class="btn-cancel">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</a>
        {% endif %}
    </div>
    
    <form action="{% if edit_mood %}/update/{{ edit_mood._id }}{% else %}/add{% endif %}" method="POST">
        <div class="form-group">
            <label>üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label>
            <input type="date" name="date" value="{% if edit_mood %}{{ edit_mood.date }}{% endif %}" required>
        </div>
        
        <div class="form-group">
            <label>üïê ‡πÄ‡∏ß‡∏•‡∏≤:</label>
            <input type="time" name="time" value="{% if edit_mood %}{{ edit_mood.time }}{% endif %}" required>
        </div>
        
        <div class="form-group">
            <label>
                üé® ‡∏™‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å:
                <span class="tooltip-container">
                    <span class="tooltip-icon">‚ÑπÔ∏è</span>
                    <div class="tooltip-content">
                        <strong>üí° ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏™‡∏µ</strong>
                        <p style="margin: 10px 0;">‡∏™‡∏µ‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß</p>
                        <div class="color-meanings">
                            <div class="color-meaning-item">
                                <span class="color-dot" style="background: #ff6b6b;"></span>
                                <span><strong>‡πÅ‡∏î‡∏á:</strong> ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏π‡∏á + ‡πÑ‡∏°‡πà‡∏û‡∏≠‡πÉ‡∏à</span>
                            </div>
                            <div class="color-meaning-item">
                                <span class="color-dot" style="background: #ffd93d;"></span>
                                <span><strong>‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á:</strong> ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏π‡∏á + ‡∏û‡∏≠‡πÉ‡∏à</span>
                            </div>
                            <div class="color-meaning-item">
                                <span class="color-dot" style="background: #6bcfff;"></span>
                                <span><strong>‡∏ü‡πâ‡∏≤:</strong> ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≥ + ‡πÑ‡∏°‡πà‡∏û‡∏≠‡πÉ‡∏à</span>
                            </div>
                            <div class="color-meaning-item">
                                <span class="color-dot" style="background: #51cf66;"></span>
                                <span><strong>‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß:</strong> ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≥ + ‡∏û‡∏≠‡πÉ‡∏à</span>
                            </div>
                        </div>
                    </div>
                </span>
            </label>
            <div class="color-options">
                <div class="color-option">
                    <input type="radio" name="color" value="‡πÅ‡∏î‡∏á" id="color-red" {% if edit_mood and edit_mood.color == '‡πÅ‡∏î‡∏á' %}checked{% elif not edit_mood %}required{% endif %}>
                    <label for="color-red" class="color-label color-red">‡πÅ‡∏î‡∏á</label>
                </div>
                <div class="color-option">
                    <input type="radio" name="color" value="‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á" id="color-yellow" {% if edit_mood and edit_mood.color == '‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á' %}checked{% endif %}>
                    <label for="color-yellow" class="color-label color-yellow">‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á</label>
                </div>
                <div class="color-option">
                    <input type="radio" name="color" value="‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô" id="color-blue" {% if edit_mood and edit_mood.color == '‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô' %}checked{% endif %}>
                    <label for="color-blue" class="color-label color-blue">‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô</label>
                </div>
                <div class="color-option">
                    <input type="radio" name="color" value="‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß" id="color-green" {% if edit_mood and edit_mood.color == '‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß' %}checked{% endif %}>
                    <label for="color-green" class="color-label color-green">‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß</label>
                </div>
            </div>
        </div>
        
        <div class="form-group">
            <label>üí• ‡∏™‡∏¥‡πà‡∏á‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô:</label>
            <input type="text" name="trigger" value="{% if edit_mood %}{{ edit_mood.trigger }}{% endif %}" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô, ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß, ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô" required>
        </div>
        
        <div class="form-group">
            <label>
                üòä ‡∏£‡∏∞‡∏ö‡∏∏‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå:
                <span class="tooltip-container">
                    <span class="tooltip-icon">‚ÑπÔ∏è</span>
                    <div class="tooltip-content">
                        <strong>üí≠ ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏∏‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå</strong>
                        <p style="margin: 10px 0;"><strong>‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏á‡∏ß‡∏•!</strong> ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏∏‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡πÑ‡∏î‡πâ‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å</p>
                        <p style="margin: 10px 0;">üìù ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ</p>
                        <p style="margin: 10px 0;">üéØ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: Wheel of Emotions</p>
                    </div>
                </span>
            </label>
            <input type="text" name="emotion" value="{% if edit_mood %}{{ edit_mood.emotion }}{% endif %}" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç, ‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î, ‡πÇ‡∏Å‡∏£‡∏ò" required>
        </div>
        
        <div class="form-group">
            <label>üìù ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î:</label>
            <textarea name="detail" placeholder="‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..." required>{% if edit_mood %}{{ edit_mood.detail }}{% endif %}</textarea>
        </div>
        
        <button type="submit" class="btn-submit">
            {% if edit_mood %}üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç{% else %}üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å{% endif %}
        </button>
    </form>
</div>

<!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (5 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£) -->
<h3 style="margin-bottom: 15px; color: #333;">üìã ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
<div class="mood-list">
    {% if moods %}
        {% for mood in moods[:5] %}
        <div class="mood-item {{ mood.color }}">
            <div class="mood-header">
                <div class="mood-datetime">
                    üìÖ {{ mood.date }} ‡πÄ‡∏ß‡∏•‡∏≤ {{ mood.time }}
                </div>
                <div class="mood-color-badge" style="background-color: 
                    {% if mood.color == '‡πÅ‡∏î‡∏á' %}#ff6b6b
                    {% elif mood.color == '‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á' %}#ffd93d; color: #333;
                    {% elif mood.color == '‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô' %}#6bcfff
                    {% elif mood.color == '‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß' %}#51cf66
                    {% endif %}">
                    {{ mood.color|upper }}
                </div>
            </div>
            <div class="mood-emotion">üòä {{ mood.emotion }}</div>
            <div class="mood-trigger">üí• ‡∏™‡∏¥‡πà‡∏á‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô: {{ mood.trigger }}</div>
            <div class="mood-detail">{{ mood.detail }}</div>
            <div class="mood-footer">
                <a href="/edit/{{ mood._id }}">
                    <button class="btn-edit">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                </a>
                <a href="/delete/{{ mood._id }}" onclick="return confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ô‡∏µ‡πâ?')">
                    <button class="btn-delete">üóëÔ∏è ‡∏•‡∏ö</button>
                </a>
            </div>
        </div>
        {% endfor %}
        
        {% if moods|length > 5 %}
        <div style="text-align: center; margin-top: 20px;">
            <a href="{{ url_for('history') }}" style="color: #667eea; text-decoration: none; font-weight: 600;">
                ‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‚Üí
            </a>
        </div>
        {% endif %}
    {% else %}
        <div class="empty-state">
            <h2>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</h2>
            <p>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!</p>
        </div>
    {% endif %}
</div>
{% endblock %}